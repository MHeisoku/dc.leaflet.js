/*!
 *  dc.leaflet 0.5.2
 *  http://dc-js.github.io/dc.leaflet.js/
 *  Copyright 2014-2015 Boyan Yurukov and the dc.leaflet Developers
 *  https://github.com/dc-js/dc.leaflet.js/blob/master/AUTHORS
 *
 *  Licensed under the Apache License, Version 2.0 (the "License");
 *  you may not use this file except in compliance with the License.
 *  You may obtain a copy of the License at
 *
 *      http://www.apache.org/licenses/LICENSE-2.0
 *
 *  Unless required by applicable law or agreed to in writing, software
 *  distributed under the License is distributed on an "AS IS" BASIS,
 *  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 *  See the License for the specific language governing permissions and
 *  limitations under the License.
 */

!function(){function a(a){"use strict";var b={version:"0.5.2"};return b.leafletBase=function(a){var b=new a;b.margins({left:0,top:0,right:0,bottom:0});var c,d=!1,e=!1,f=!1,g=!1,h=null,i=null,j={},k=function(a){var c=a.selectAll("div.dc-leaflet");return c=c.data([0]).enter().append("div").attr("class","dc-leaflet").style("width",b.effectiveWidth()+"px").style("height",b.effectiveHeight()+"px").merge(c),L.map(c.node(),e)},l=function(a){L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:'&copy; <a href="https://openstreetmap.org/copyright">OpenStreetMap</a> contributors'}).addTo(a)};b.createLeaflet=function(a){return arguments.length?(k=a,b):k},b._doRender=function(){if(b.map())b.map()&&d?b._postRender():console.warn("WARNING: Leaflet map already rendered.");else{c=k(b.root());for(var a in j)c.on(a,j[a]);f&&g&&c.setView(b.toLocArray(f),g),b.tiles()(c),b._postRender()}return b._doRedraw()},b._doRedraw=function(){return b},b._postRender=function(){return b},b.mapOptions=function(a){return arguments.length?(e=a,b):e},b.center=function(a){return arguments.length?(f=a,b):f},b.zoom=function(a){return arguments.length?(g=a,b):g},b.tiles=function(a){return arguments.length?(l=a,b):l},b.map=function(a){return arguments.length?(c=a,d=!0,b):c},b._isMac=navigator.platform.toUpperCase().includes("MAC"),b._modAssignment={shift:"shiftKey",alt:"altKey",ctrlCmd:b._isMac?"metaKey":"ctrlKey"},b.popupMod=function(a){return arguments.length?(h=a,b):h},b.filterMod=function(a){return arguments.length?(i=a,b):i},b.modKeyMatches=function(a,c){return c?a.originalEvent[b._modAssignment[c]]:!(a.originalEvent.shiftKey||a.originalEvent.altKey||a.originalEvent.ctrlKey||a.originalEvent.metaKey)},b.bindPopupWithMod=function(a,c){a.bindPopup(c),a.off("click",a._openPopup),a.on("click",function(c){b.modKeyMatches(c,b.popupMod())&&a._openPopup(c)})},b.toLocArray=function(a){return"string"==typeof a&&(a=a.split(",")),a};const m=b.on;return b.on=function(a,b){var d=["zoomend","moveend"];return d.indexOf(a)>=0?(c?c.on(a,b):j[a]=b,this):m.call(this,a,b)},b},b.legend=function(){function a(){return L.Control.extend({options:{position:e},onAdd:function(a){return a.legend?a.legend.setContent(""):a.legend=this,this._div=L.DomUtil.create("div","info legend"),a.on("moveend",this._update,this),this._update(),this._div},setContent:function(a){return this.getContainer().innerHTML=a},_update:function(){if(b.colorDomain){var a,c=b.colorDomain()[0],d=b.colorDomain()[1],e=b.colors().range(),g=b.colors().range().length,h=(d-c)/g,i=[];for(i[0]=Math.round(c),a=1;a<g;a++)i[a]=Math.round((.5+(a-1))*h+c);L.DomUtil.create("div","info legend");for(f?this._div.innerHTML="<strong>"+f+"</strong><br/>":this._div.innerHTML="",a=0;a<i.length;a++)this._div.innerHTML+='<i style="background:'+e[a]+'"></i> '+i[a]+(i[a+1]?"&ndash;"+i[a+1]+"<br>":"+")}else console.warn("legend not supported for this dc.leaflet chart type, ignoring")}})}var b,c={},d=null,e="bottomleft",f=!1;return c.parent=function(a){return arguments.length?(b=a,this):b},c.LegendClass=function(b){return arguments.length?(a=b,c):a},c.legendTitle=function(a){return arguments.length?(f=a,c):f},c.render=function(){if(!d){var a=c.LegendClass()();d=new a,d.addTo(b.map())}return c.redraw()},c.redraw=function(){return d._update(),c},c.leafletLegend=function(){return d},c.position=function(a){return arguments.length?(e=a,c):e},c},b.markerChart=function(c,d){var e=b.leafletBase(a.MarginMixin),f=!0,g=!1,h=!1,i=!1,j=!0,k=!1,l=!1,m=!1,n=!1,o=!1,p=!1,q=[],r=!1,s=!0,t=!1,u=!1,v=!0,w=function(a){return e.keyAccessor()(a)},x=function(a,b){var c=new L.Marker(e.toLocArray(e.locationAccessor()(a)),{title:v?e.title()(a):"",alt:v?e.title()(a):"",icon:y(a,b),clickable:e.renderPopup()||e.brushOn()&&!k,draggable:!1});return c},y=function(a,b){return new L.Icon.Default},z=function(a,b){return e.title()(a)};e._postRender=function(){e.brushOn()&&(k&&e.filterHandler(D),e.map().on("zoomend moveend",C,this),k||e.map().on("click",C,this),e.map().on("zoomstart",B,this)),p=g?new L.MarkerClusterGroup(h?h:null):new L.LayerGroup,e.map().addLayer(p)},e._doRedraw=function(){var a=e._computeOrderedGroups(e.data()).filter(function(a){return 0!==e.valueAccessor()(a)});if(!r||r.toString()!==a.toString()){r=a,i&&(q=[]),p.clearLayers();var b=[];m=!1,a.forEach(function(a,c){var d=e.keyAccessor()(a),f=null;f=!i&&d in q?q[d]:A(a,d),e.cluster()?b.push(f):p.addLayer(f)}),e.cluster()&&b.length>0&&p.addLayers(b),b.length>0&&(s||t&&!u)&&(m=new L.featureGroup(b),e.map().fitBounds(m.getBounds())),u=!1,s=!1}},e.locationAccessor=function(a){return arguments.length?(w=a,e):w},e.marker=function(a){return arguments.length?(x=a,e):x},e.featureGroup=function(a){return arguments.length?(m=a,e):m},e.icon=function(a){return arguments.length?(y=a,e):y},e.popup=function(a){return arguments.length?(z=a,e):z},e.clickEvent=function(a){return arguments.length?(l=a,e):l},e.renderPopup=function(a){return arguments.length?(f=a,e):f},e.cluster=function(a){return arguments.length?(g=a,e):g},e.clusterOptions=function(a){return arguments.length?(h=a,e):h},e.rebuildMarkers=function(a){return arguments.length?(i=a,e):i},e.brushOn=function(a){return arguments.length?(j=a,e):j},e.filterByArea=function(a){return arguments.length?(k=a,e):k},e.fitOnRender=function(a){return arguments.length?(s=a,e):s},e.fitOnRedraw=function(a){return arguments.length?(t=a,e):t},e.showMarkerTitle=function(a){return arguments.length?(v=a,e):v},e.markerGroup=function(){return p};var A=function(a,b){var c=x(a,e.map());return c.key=b,e.renderPopup()&&e.bindPopupWithMod(c,e.popup()(a,c)),e.brushOn()&&!k&&c.on("click",E),l&&c.on("click",l),q[b]=c,c},B=function(a){o=!0},C=function(b){if("moveend"!==b.type||!o&&!b.hard)if(o=!1,k){var c;c=e.map().getCenter().equals(e.center())&&e.map().getZoom()===e.zoom()?null:e.map().getBounds(),a.events.trigger(function(){e.filter(null),c&&(n=!0,e.filter(c),n=!1),a.redrawAll(e.chartGroup())})}else e.filter()&&("click"===b.type||q.indexOf(e.filter())!==-1&&!e.map().getBounds().contains(q[e.filter()].getLatLng()))&&a.events.trigger(function(){e.filter(null),f&&e.map().closePopup(),a.redrawAll(e.chartGroup())})},D=function(a,b){e.dimension().filter(null),b&&b.length>0&&(e.dimension().filterFunction(function(a){if(!(a in q))return!1;var c=q[a].getLatLng();return c&&b[0].contains(c)}),n||e.map().getBounds().toString===b[0].toString()||e.map().fitBounds(b[0]))},E=function(b){if(b.target&&e.modKeyMatches(b,e.filterMod())){var c=b.target.key;a.events.trigger(function(){e.filter(c),a.redrawAll(e.chartGroup())})}};return e.anchor(c,d)},b.choroplethChart=function(c,d){var e=b.leafletBase(a.ColorMixin(a.MarginMixin)),f=!1,g=[],h=!1,i=!0,j=!0,k={fillColor:"black",color:"gray",opacity:.4,fillOpacity:.6,weight:1},l=function(a){return a.key},m=function(a){var b=e.featureOptions();b instanceof Function&&(b=b(a)),b=JSON.parse(JSON.stringify(b));var c=g[e.featureKeyAccessor()(a)];return c&&c.d&&(b.fillColor=e.getColor(c.d,c.i),e.filters().indexOf(c.d.key)!==-1&&(b.opacity=.8,b.fillOpacity=1)),b},n=function(a,b){return e.title()(a)};e._postRender=function(){f=L.geoJson(e.geojson(),{style:e.featureStyle(),onEachFeature:p}),e.map().addLayer(f)};const o=e._doRedraw;e._doRedraw=function(){return f.clearLayers(),g=[],e._computeOrderedGroups(e.data()).forEach(function(a,b){g[e.keyAccessor()(a)]={d:a,i:b}}),f.addData(e.geojson()),o.call(this)},e.geojson=function(a){return arguments.length?(h=a,e):h},e.featureOptions=function(a){return arguments.length?(k=a,e):k},e.featureKeyAccessor=function(a){return arguments.length?(l=a,e):l},e.featureStyle=function(a){return arguments.length?(m=a,e):m},e.popup=function(a){return arguments.length?(n=a,e):n},e.renderPopup=function(a){return arguments.length?(i=a,e):i},e.brushOn=function(a){return arguments.length?(j=a,e):j};var p=function(a,b){var c=g[e.featureKeyAccessor()(a)];c&&c.d&&(b.key=c.d.key,e.renderPopup()&&e.bindPopupWithMod(b,e.popup()(c.d,a)),e.brushOn()&&b.on("click",q))},q=function(b){if(b.target&&e.modKeyMatches(b,e.filterMod())){var c=b.target.key;a.events.trigger(function(){e.filter(c),a.redrawAll(e.chartGroup())})}};return e.anchor(c,d)},b.bubbleChart=function(c,d){function e(b){var c=[];j.eachLayer(function(a){var d=a.getLatLng();b.boxZoomBounds.contains(d)&&c.push(a.key)}),a.events.trigger(function(a){f.replaceFilter([c]),f.redrawGroup()})}var f=b.leafletBase(a.ColorMixin(a.MarginMixin));f.linearColors(["gray"]);var g="blue",h=function(a){return f.getColor(a)},i=!0,j=!1,k=function(a){return f.keyAccessor()(a)},l=function(a,b){return f.title()(a)},m=d3.scaleLinear().domain([0,100]),n=!0,o=function(a,b){var c=f.locationAccessor()(a),d=f.toLocArray(c),e=L.latLng(+d[0],+d[1]),g=L.circleMarker(e);g.setRadius(f.r()(f.valueAccessor()(a))),g.on("mouseover",function(a){f.renderPopup&&this.openPopup()}),g.on("mouseout",function(a){f.renderPopup&&this.closePopup()});var h=f.keyAccessor()(a),i=-1!==f.filters().indexOf(h);return g.options.color=i?f.selectedColor():f.unselectedColor()(a),g};f.r=function(a){return arguments.length?(m=a,f):m},f.brushOn=function(a){return arguments.length?(n=a,f):n},f.locationAccessor=function(a){return arguments.length?(k=a,f):k},f.selectedColor=function(a){return arguments.length?(g=a,f):g},f.unselectedColor=function(a){return arguments.length?(h=a,f):h},f.popup=function(a){return arguments.length?(l=a,f):l},f.layerGroup=function(){return j},f.renderPopup=function(a){return arguments.length?(i=a,f):i};var p=function(a,b){var c=f.marker()(a,f.map());return c.key=b,f.renderPopup()&&f.bindPopupWithMod(c,f.popup()(a,c)),f.brushOn()&&c.on("click",q),c};f.marker=function(a){return arguments.length?(o=a,f):o},f._postRender=function(){f.brushOn()&&f.map().on("click",function(a){f.filter(null),f.redrawGroup()}),f.map().on("boxzoomend",e,this),j=new L.LayerGroup,f.map().addLayer(j)},f._doRedraw=function(){var a=f._computeOrderedGroups(f.data()).filter(function(a){return 0!==f.valueAccessor()(a)});j.clearLayers(),a.forEach(function(a,b){var c=f.keyAccessor()(a),d=null;d=p(a,c),j.addLayer(d)})};var q=function(a){if(a.target){var b=a.target.key;L.DomEvent.stopPropagation(a);var b=a.target.key;a.originalEvent.ctrlKey||a.originalEvent.metaKey?f.filter(b):f.replaceFilter([[b]]),f.redrawGroup()}};return f.anchor(c,d)},b.d3=d3,b.crossfilter=crossfilter,b.dc=a,b}if("function"==typeof define&&define.amd)define(["dc"],a);else if("object"==typeof module&&module.exports){var b=require("dc");module.exports=a(b)}else this.dc_leaflet=a(dc)}();
//# sourceMappingURL=dc.leaflet.min.js.map